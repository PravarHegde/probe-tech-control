import{m as h,B as p,I as c,P as m,R as u,W as g,C as v,n as b}from"./index-DJ3qMuuj.js";import"./vuetify-DgukJE4S.js";import"./overlayscrollbars-CiKU261J.js";import"./echarts-DzoUeqWp.js";var d=Object.defineProperty,f=Object.getOwnPropertyDescriptor,a=(n,t,e,s)=>{for(var i=s>1?void 0:s?f(t,e):t,o=n.length-1,l;o>=0;o--)(l=n[o])&&(i=(s?l(t,e,i):l(i))||i);return s&&i&&d(t,e,i),i};let r=class extends h(p,c){constructor(){super(...arguments),this.aspectRatio=null,this.isVisible=!1,this.isVisibleViewport=!1,this.isVisibleDocument=!0}get url(){var t;return this.convertUrl((t=this.camSettings)==null?void 0:t.stream_url,this.printerUrl)}get wrapperStyle(){return this.getWrapperStyle(this.aspectRatio,this.camSettings.rotation)}get webcamStyle(){var t,e,s,i;return{transform:this.generateTransform((t=this.camSettings.flip_horizontal)!=null?t:!1,(e=this.camSettings.flip_vertical)!=null?e:!1,(s=this.camSettings.rotation)!=null?s:0,(i=this.aspectRatio)!=null?i:1)}}mounted(){document.addEventListener("visibilitychange",this.documentVisibilityChanged)}beforeDestroy(){document.removeEventListener("visibilitychange",this.documentVisibilityChanged),this.stopStream()}startStream(){var t;this.isVisible||(t=this.image)==null||t.setAttribute("src",this.url)}stopStream(){this.image&&(this.image.removeAttribute("src"),URL.revokeObjectURL(this.url))}documentVisibilityChanged(){const t=document.visibilityState;this.isVisibleDocument=t==="visible",this.isVisibleDocument||this.stopStream(),this.visibilityChanged()}viewportVisibilityChanged(t){this.isVisibleViewport=t,this.visibilityChanged()}visibilityChanged(){if(this.isVisibleViewport&&this.isVisibleDocument){this.startStream();return}this.stopStream()}onload(){this.aspectRatio===null&&(this.aspectRatio=this.updateAspectRatioFromImage(this.image))}async urlChanged(){this.stopStream(),this.startStream()}};a([m({required:!0})],r.prototype,"camSettings",2);a([m({default:null})],r.prototype,"printerUrl",2);a([u("image")],r.prototype,"image",2);a([g("url")],r.prototype,"urlChanged",1);r=a([v],r);var y=function(){var t=this,e=t._self._c;return t._self._setupProxy,e("div",{staticClass:"webcamBackground",style:t.wrapperStyle},[e("img",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:t.viewportVisibilityChanged,expression:"viewportVisibilityChanged"}],ref:"image",staticClass:"webcamImage",style:t.webcamStyle,attrs:{draggable:"false",alt:t.camSettings.name},on:{load:t.onload}})])},_=[],S=b(r,y,_,!1,null,null);const U=S.exports;export{U as default};
